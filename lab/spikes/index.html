<!doctype html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="author" content="Paul Lewis" />
  <meta name="viewport" content="width=device-width">

  
  <link rel="alternate" type="application/rss+xml" title="RSS" href="//aerotwist.com/lab/feed/">
  

  

  <style>
    
    @font-face {
      font-family: 'Lato';
      font-style: normal;
      font-weight: 400;
      src: local('Lato Regular'), local('Lato-Regular'), url(//themes.googleusercontent.com/static/fonts/lato/v7/qIIYRU-oROkIk8vfvxw6QvesZW2xOQ-xsNqO47m55DA.woff) format('woff');
    }
    

    @font-face {
      font-family: 'Lato';
      font-style: normal;
      font-weight: 700;
      src: local('Lato Bold'), local('Lato-Bold'), url(//themes.googleusercontent.com/static/fonts/lato/v7/qdgUG4U09HnJwhYI-uK18wLUuEpTyoUstqEm5AMlJo4.woff) format('woff');
    }
  </style>

  <link rel="stylesheet" media="screen" href="/css/aerotwist.css" />
  <title>Aerotwist - Spikes</title>
  
  <style>
    .masthead h2 {
      display: none;
    }

    .masthead {
      background-image: url(/static/lab/headers/header-spikes-small.jpg);
      
      background-color: #222;
      
      
    }

    .meta {
      background-color: #222 !important;
    }

    @media (min-width: 600px) {
      .masthead {
        background-image: url(/static/lab/headers/header-spikes.jpg);
      }
    }
  </style>
  
</head>


<!--
                              __          .__          __
  _____    ___________  _____/  |___  _  _|__| _______/  |_
  \__  \ _/ __ \_  __ \/  _ \   __\ \/ \/ /  |/  ___/\   __\
   / __ \\  ___/|  | \(  <_> )  |  \     /|  |\___ \  |  |
  (____  /\___  >__|   \____/|__|   \/\_/ |__/____  > |__|
       \/     \/                                  \/

  Giant ascii art embedded in every page of your site is how you
  show other people that YOU CARE. Mainly I care about developers,
  which is what I presume you are if you're all about viewing
  the source. Clearly you're my kind of person.

  This is v3, it's run through Jekyll, it's been fun to build,
  there's always more to do, and you may notice that aside from
  Google Analytics there is no JavaScript. None.

  That's one way of many you keep your pages fast. I care about
  keeping this site fast because your time is precious and I need
  to get out of your way.

  <3'z

  Paul
-->


  <body class="lab">

    <header>
      <div class="container">
        <div id="logo">
  <a href="/">
    <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
       width="100%" height="100%">
    <g>
      <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#CCDBD4" points="30.6,47.73 64.92,47.73 19.97,76.52"></polygon>
      <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#FFF194" points="48.198,0 53.008,14.06 39.31,24.76"></polygon>
      <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#89C13D" points="39.31,24.76 64.92,48 30.6,48"></polygon>
      <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#EADF3E" points="39.31,24.76 64.92,48 53.008,14.06"></polygon>
      <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#004C26" points="30.6,48 64.92,48 48,58.69"></polygon>
      <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#7FA592" points="47.76,58.69 64.92,47.73 75.14,76.73"></polygon>
    </g>
    </svg>
  </a>
</div>

        <nav>
  <ul>
    
      
        <li><a href="/">Home</a></li>
      
    
      
        <li><a href="/blog/">Blog</a></li>
      
    
      
        <li><a href="/tutorials/">Tutorials</a></li>
      
    
      
        <li class="active"><a href="/lab/"> Lab</a></li>
      
    
  </ul>

  <svg id="left-line" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
       width="380px" height="380px" viewBox="0 0 380 380">
    <line x1="0" y1="380" x2="380" y2="0" stroke="#AAAAAA" stroke-width="1" />
    </svg>

  <svg id="right-line" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
       width="380px" height="380px" viewBox="0 0 380 380">
    <line x1="0" y1="380" x2="380" y2="0" stroke="#CCDBD4" stroke-opacity="0.3" stroke-width="1" />
    </svg>
</nav>

      </div>
    </header>
    <section>

      <div class="content">

  <div class="masthead">

    

    <div class="container">
      <h2>Spikes</h2>
      <p></p>
    </div>

  </div>

  <div class="container"><div class="left column"><p class="livedemo"><a href="http://lab.aerotwist.com/css/spikes/">See the experiment</a></p>

<h2 id="synopsis">Synopsis</h2>

<p>For a while now Webkit browsers (Chrome and Safari being the most notable) have supported 3D transforms. As it happens support for this has also recently been extended to include Firefox. Given 3D transforms are part of the HTML5 spec we can expect it to show up everywhere in the end. I thought it might be interesting to see how far I could push it. With some sleight of hand I think I managed to create something that doesn’t look like it’s been created with CSS.</p>

<h2 id="shape_shifter">Shape Shifter</h2>

<p>If you’re looking at the shape thinking that it doesn’t look particularly like a cube or other boxy shape, then you may also wonder how that was done. Ultimately CSS 3D transforms are taking standard block (box) elements, like divs, and pushing them into a 3D space. That’s true, but nobody ever said they couldn’t be “textured” to look like a different shape! That’s what’s going on here: each spike is eight divs, each with a triangular image as its “texture”. With a few rotations and translations you get the shape we’re talking about.</p>

<h2 id="but_it_looks_lit">But It Looks Lit!</h2>

<p>Absolutely. And this is another part of the sleight of hand. To do this required two things: face normals and a sprite. If you imagine that each div starts by looking out towards the screen, then if you know your 3D maths you can deduce it’s got a face normal vector of [0,0,1]. Every rotation on the div is repeated on the face normal so that we have something representative of the div’s final face direction. How does this help? Well when it comes to drawing everything we can use this face normal to work out how much light it gets, and therefore what colour to use. For simplicity I just used the dot product of the face normal and the light direction, the net result is something like a directional light in a 3D package.</p>

<h2 id="what_about_the_sprite">What About the Sprite?</h2>

<p>This was totally fun to do. All I ended up doing was drawing out the triangle shape about 40 times into a canvas, running from black through to the pink colour. To help with that I used HSL values rather than RGB when drawing the shapes. If you don’t know about HSL you should take a look as it’s totally perfect for this kind of work. In short it allows you to set a hue (the H in HSL), a saturation (S) and the lightness (L) which means if you run the lightness from 0 upwards it goes from black to the hue (at the saturation) you’ve set. Neat! Once I had the canvas drawn out (which looks <a href="/static/lab/spikes/sprite.png">like this</a>, by the way) I used the value from the dot product to shift the background position on each face to match the correct lightness.</p>

<h2 id="whats_the_point">What’s the Point?</h2>

<p>Well there isn’t one, really. I wanted to see if it was possible to do something pretty cool but without much practical application in CSS. Mainly it’s about finding out where the boundaries are of the technology, which I don’t think I’ve done; I’m pretty certain it can take much more! This is, I think, because it uses the GPU so you are given quite a lot of punch to do the rendering. On the flip side I had to do all the lighting calculations in the JavaScript, which isn’t ideal.</p>

<p>To be honest if I were going to attempt something like this commercially I would be more inclined to do it using WebGL as it’s much better at this kind of stuff compared to CSS. With that said it’s great to know it can be done if required, and really I can’t help but smile at an experiment that pushes on the boundaries of what we do with CSS. If only to show that with a bit of creativity you can do something a little weird and unexpected.</p></div></div>

</div>


    </section>

    <footer>

      <div class="container">
        <div class="bio panel">
          <h2>Hello!</h2>
          <p>My name is Paul. I work at <a href="http://www.google.com/" title="Some cloud company in the USA, I think.">Google</a> on the Chrome Developer Relations team as an advocate. I help developers improve the performance of their sites and apps.</p>

          <p>You can find me on <a href="http://twitter.com/aerotwist">Twitter</a> and <a href="http://www.google.com/+aerotwist">G+</a></p>
        </div>

        <div class="get-in-touch panel">
          <h2>Get in touch</h2>
          <p>I don’t bite. Honestly. You can find me on <a href="http://twitter.com/aerotwist">Twitter</a> and <a href="http://www.google.com/+aerotwist">G+</a>, and I like hearing from people (pretty handy given my job, really) so say hi.</p>
        </div>

        <div class="subscribe panel">
          <h2>Subscribe</h2>
          <p>You should totally get the <a href="/blog/feed/">RSS feed</a>, or whatever it is you kids are using these days (I miss Reader.)</p>
        </div>

        <p class="disclaimer">Except as otherwise noted, the content of this page is licensed under the Creative Commons Attribution 3.0 License, and code samples are licensed under the Apache 2.0 License.</p>
      </div>
    </footer>

    <script async="true">

    /**
     * Snow effect, from: HTML5 Rocks
     * https://github.com/html5rocks/www.html5rocks.com/blob/9318b5755c8c17a4bd1761bca6b1b491e7fd17b8/content/index.html
     */
    !function(){function j(){f=c.clientWidth,g=c.clientHeight,d.width=f,d.height=g,e.fillStyle="#FFF";var a=i;i=f>600,!a&&i&&requestAnimFrame(n)}function n(){if(e.clearRect(0,0,f,g),i){for(h=0;b>h;h++)m=l[h],m.y+=m.vy,m.x+=m.vx,e.globalAlpha=m.o,e.beginPath(),e.arc(m.x,m.y,m.r,0,2*Math.PI,!1),e.closePath(),e.fill(),m.y>g&&m.reset();requestAnimFrame(n)}}var a=(new Date).getMonth();if(11===a){var b=300,c=document.querySelector(".masthead");if(c){var d=document.createElement("canvas"),e=d.getContext("2d"),f=c.clientWidth,g=c.clientHeight,h=0,i=!1,k=function(){this.x=0,this.y=0,this.vy=0,this.vx=0,this.r=0,this.reset()};k.prototype.reset=function(){this.x=Math.random()*f,this.y=Math.random()*-g,this.vy=1+3*Math.random(),this.vx=.5-Math.random(),this.r=1+2*Math.random(),this.o=.5+.5*Math.random()},d.style.position="absolute",d.style.left=d.style.top="0";var m,l=[];for(h=0;b>h;h++)m=new k,m.reset(),l.push(m);window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)}}(),j(),window.addEventListener("resize",j,!1),c.appendChild(d)}}}();
    </script>

    <script type="text/javascript" async="true">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-13024693-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
  </body>
</html>
