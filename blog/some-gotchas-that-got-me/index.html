<!doctype html>
<html itemscope itemtype="http://schema.org/Article">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="author" content="Paul Lewis" />
  <meta name="viewport" content="width=device-width">
  <meta name="theme-color" content="#880043">

  
  <link rel="alternate" type="application/rss+xml" title="RSS" href="//aerotwist.com/blog/feed/">
  

  
  <meta name="twitter:site" content="@aerotwist">
  <meta name="twitter:creator" content="@aerotwist">
  <meta name="twitter:title" content="Some Gotchas That Got Me">
  <meta name="twitter:description" content="I&#39;ve been building a web app recently and I&#39;ve had one of those builds. You know, one of the ones where you seem to stumble across a bunch of bugs or bonkers behaviours that cause you to question your own sanity...">

  <meta itemprop="name" content="Some Gotchas That Got Me">
  <meta itemprop="description" content="I&#39;ve been building a web app recently and I&#39;ve had one of those builds. You know, one of the ones where you seem to stumble across a bunch of bugs or bonkers behaviours that cause you to question your own sanity...">

    
    <meta name="twitter:card" content="summary">
    

  

  <style>
    
    @font-face {
      font-family: 'Lato';
      font-style: normal;
      font-weight: 400;
      src: local('Lato Regular'), local('Lato-Regular'), url(//themes.googleusercontent.com/static/fonts/lato/v7/qIIYRU-oROkIk8vfvxw6QvesZW2xOQ-xsNqO47m55DA.woff) format('woff');
    }
    

    @font-face {
      font-family: 'Lato';
      font-style: normal;
      font-weight: 700;
      src: local('Lato Bold'), local('Lato-Bold'), url(//themes.googleusercontent.com/static/fonts/lato/v7/qdgUG4U09HnJwhYI-uK18wLUuEpTyoUstqEm5AMlJo4.woff) format('woff');
    }
  </style>

  <link rel="stylesheet" media="screen" href="/css/aerotwist.css" />
  <title>Aerotwist - Some Gotchas That Got Me</title>
  
</head>


<!--
                              __          .__          __
  _____    ___________  _____/  |___  _  _|__| _______/  |_
  \__  \ _/ __ \_  __ \/  _ \   __\ \/ \/ /  |/  ___/\   __\
   / __ \\  ___/|  | \(  <_> )  |  \     /|  |\___ \  |  |
  (____  /\___  >__|   \____/|__|   \/\_/ |__/____  > |__|
       \/     \/                                  \/

  Giant ascii art embedded in every page of your site is how you
  show other people that YOU CARE. Mainly I care about developers,
  which is what I presume you are if you're all about viewing
  the source. Clearly you're my kind of person.

  This is v3, it's run through Jekyll, it's been fun to build,
  there's always more to do, and you may notice that aside from
  Google Analytics there is no JavaScript. None.

  That's one way of many you keep your pages fast. I care about
  keeping this site fast because your time is precious and I need
  to get out of your way.

  <3'z

  Paul
-->


  <body class="blog">

    <header>
      <div class="container">
        <div id="logo">
  <a href="/">
    <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
       width="100%" height="100%">
    <g>
      <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#6EBAD3" points="30.6,47.73 64.92,47.73 19.97,76.52"></polygon>
      <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#ED95C0" points="48.198,0 53.008,14.06 39.31,24.76"></polygon>
      <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#880043" points="39.31,24.76 64.92,48 30.6,48"></polygon>
      <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#DA0A7A" points="39.31,24.76 64.92,48 53.008,14.06"></polygon>
      <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#0B7DAD" points="30.6,48 64.92,48 48,58.69"></polygon>
      <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#BDDEE8" points="47.76,58.69 64.92,47.73 75.14,76.73"></polygon>
    </g>
    </svg>
  </a>
</div>

        <nav>
  <ul>
    
      
        <li><a href="/">Home</a></li>
      
    
      
        <li class="active"><a href="/blog/"> Blog</a></li>
      
    
      
        <li><a href="/tutorials/">Tutorials</a></li>
      
    
      
        <li><a href="/lab/">Lab</a></li>
      
    
  </ul>

  <svg id="left-line" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
       width="380px" height="380px" viewBox="0 0 380 380">
    <line x1="0" y1="380" x2="380" y2="0" stroke="#AAAAAA" stroke-width="1" />
    </svg>

  <svg id="right-line" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
       width="380px" height="380px" viewBox="0 0 380 380">
    <line x1="0" y1="380" x2="380" y2="0" stroke="#6EBAD3" stroke-opacity="0.3" stroke-width="1" />
    </svg>
</nav>

      </div>
    </header>
    <section>

      <div class="content">

  
  <svg version="1.1" class="shape-reference" xmlns="http://www.w3.org/2000/svg" width="861" height="291">
  <defs>
    <filter id="blur-8">
      <feGaussianBlur in="SourceGraphic" stdDeviation="8" />
    </filter>
    <filter id="blur-6">
      <feGaussianBlur in="SourceGraphic" stdDeviation="6" />
    </filter>
    <filter id="blur-4">
      <feGaussianBlur in="SourceGraphic" stdDeviation="4" />
    </filter>
  </defs>

  <g id="color-block">
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#5071a7" stroke="#5071a7" stroke-width="0.6" points="40,155 112,99 125,180"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#6b6ea9" stroke="#6b6ea9" stroke-width="0.6" points="125,180 112,99 145,135"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#654885" stroke="#654885" stroke-width="0.6" points="240,171 125,180 145,135"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#4b2c58" stroke="#4b2c58" stroke-width="0.6" points="222,223 125,180 240,171"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#531c49" stroke="#531c49" stroke-width="0.6" points="222,223 240,171 321,200"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#421033" stroke="#421033" stroke-width="0.6" points="222,223 321,200 341,216"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#8e155f" stroke="#8e155f" stroke-width="0.6" points="341,216 321,200 344,118"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#ce157f" stroke="#ce157f" stroke-width="0.6" points="341,216 344,118 405,122"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#b30963" stroke="#b30963" stroke-width="0.6" points="341,216 405,122 433,175"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#5e0434" stroke="#5e0434" stroke-width="0.6" points="426,237 341,216 433,175"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#7a0341" stroke="#7a0341" stroke-width="0.6" points="499,182 426,237 433,175"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#3d0423" stroke="#3d0423" stroke-width="0.6" points="490,251 426,237 499,182"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#400b2c" stroke="#400b2c" stroke-width="0.6" points="499,182 612,218 490,251"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#7d195b" stroke="#7d195b" stroke-width="0.6" points="532,150 612,218 499,182"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#87256d" stroke="#87256d" stroke-width="0.6" points="587,145 612,218 532,150"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#692b66" stroke="#692b66" stroke-width="0.6" points="612,218 587,145 668,176"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#a04398" stroke="#a04398" stroke-width="0.6" points="668,176 587,145 596,107"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#8d4899" stroke="#8d4899" stroke-width="0.6" points="685,152 668,176 596,107"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#5f4b84" stroke="#5f4b84" stroke-width="0.6" points="668,176 685,152 751,163"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#5f64a2" stroke="#5f64a2" stroke-width="0.6" points="751,163 685,152 771,123"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#4d77aa" stroke="#4d77aa" stroke-width="0.6" points="751,163 771,123 821,140"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#9182b6" stroke="#9182b6" stroke-width="0.6" points="685,152 667,87 771,123"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#ad7cb6" stroke="#ad7cb6" stroke-width="0.6" points="596,107 667,87 685,152"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#cfa3cc" stroke="#cfa3cc" stroke-width="0.6" points="596,107 601,76 667,87"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#e6bbdb" stroke="#e6bbdb" stroke-width="0.6" points="596,107 526,40 601,76"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#ebb3d7" stroke="#ebb3d7" stroke-width="0.6" points="499,81 526,40 596,107"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#f8c5e2" stroke="#f8c5e2" stroke-width="0.6" points="499,81 435,74 526,40"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#fb82c0" stroke="#fb82c0" stroke-width="0.6" points="499,81 405,122 435,74"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#f83197" stroke="#f83197" stroke-width="0.6" points="499,81 433,175 405,122"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#e61084" stroke="#e61084" stroke-width="0.6" points="499,182 433,175 499,81"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#d82b91" stroke="#d82b91" stroke-width="0.6" points="532,150 499,182 499,81"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#d769b0" stroke="#d769b0" stroke-width="0.6" points="596,107 532,150 499,81"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#bd449b" stroke="#bd449b" stroke-width="0.6" points="587,145 532,150 596,107"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#fda1cf" stroke="#fda1cf" stroke-width="0.6" points="416,43 435,74 405,122"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#fde3f1" stroke="#fde3f1" stroke-width="0.6" points="435,74 416,43 526,40"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#f590c6" stroke="#f590c6" stroke-width="0.6" points="405,122 340,101 416,43"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#e75cab" stroke="#e75cab" stroke-width="0.6" points="405,122 344,118 340,101"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#d678b7" stroke="#d678b7" stroke-width="0.6" points="344,118 238,99 340,101"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#ba52a1" stroke="#ba52a1" stroke-width="0.6" points="344,118 240,171 238,99"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#9d2476" stroke="#9d2476" stroke-width="0.6" points="321,200 240,171 344,118"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#965ba2" stroke="#965ba2" stroke-width="0.6" points="145,135 238,99 240,171"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#c0a3cb" stroke="#c0a3cb" stroke-width="0.6" points="145,135 213,50 238,99"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#b5aacd" stroke="#b5aacd" stroke-width="0.6" points="145,135 112,99 213,50"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#ecd2e7" stroke="#ecd2e7" stroke-width="0.6" points="238,99 213,50 339,42"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#e6add3" stroke="#e6add3" stroke-width="0.6" points="238,99 339,42 340,101"/>
    <polygon fill-rule="evenodd" clip-rule="evenodd" fill="#f8cde5" stroke="#f8cde5" stroke-width="0.6" points="340,101 339,42 416,43"/>
  </g>
</svg>

  

  <div class="masthead hatched">

    
      <svg class="behind-meta" width="861" height="291">
        <use xlink:href="#color-block" />
      </svg>

      <svg class="left-meta" width="861" height="291">
        <use xlink:href="#color-block" filter="url(#blur-6)" transform="translate(430 145) scale(-0.5 0.5) translate(-431 -146)" />
      </svg>
    

    <div class="container">
      <h2>Some Gotchas That Got Me</h2>
      <p>I've been building a web app recently and I've had one of those builds. You know, one of the ones where you seem to stumble across a bunch of bugs or bonkers behaviours that cause you to question your own sanity...</p>
    </div>

  </div>

  <div class="container">
    <div class="meta">

      <ul>
        <li class="last-updated">
          <span class="name">Last updated:</span>
          <span class="value">18 Oct 2014</span>
        </li>

        <li>
          <span class="name">Est. Read Time:</span>
          <span class="value">6 mins</span>
        </li>

        <li class="share">
          <span class="name">Share this:</span>
          <span class="value"><a href="http://www.twitter.com/share?url=https://aerotwist.com/blog/some-gotchas-that-got-me/&text=Some Gotchas That Got Me">Twitter</a></span>
          <span class="value"><a href="https://plus.google.com/share?url=https://aerotwist.com/blog/some-gotchas-that-got-me/">Google+</a></span>
        </li>
        <li class="tags">
          <span class="name">Tagged:</span>
          <span class="value">
          
            #gotchas, 
          
            #lesigh, 
          
            #web
          
          </span>
        </li>
      </ul>
    </div>
  </div>

  <div class="container"><div class="left column">
<p>In the interests of perhaps helping someone else, here are some of the things I’ve hit:</p>

<h2 id="fixed-position-isnt-always-well-fixed">1. Fixed position isn’t always, well, fixed</h2>

<p>I tend to work on the basis that <code>position:fixed</code> sticks things to the viewport. That’s what the spec says anyway:</p>

<blockquote class="quote">
  <p>Fixed positioning is similar to absolute positioning. The only difference is that for a fixed positioned box, the containing block is established by the viewport.</p>
</blockquote>

<p>Turns out that’s not true if an ancestor of the <code>position:fixed</code> element has a <code>transform</code> applied to it. If it does then browsers seem to redefine what “viewport” means, and in particular it seems to mean “the element that has the transform”.</p>

</div></div>

<div class="highlight"><pre><code class="language-css" data-lang="css"><span class="nc">.container</span> <span class="p">{</span>
  <span class="k">width</span><span class="o">:</span> <span class="m">300px</span><span class="p">;</span>
  <span class="k">height</span><span class="o">:</span> <span class="m">200px</span><span class="p">;</span>

  <span class="c">/* Applying this makes the</span>
<span class="c">     fixed position child 300x200px */</span>
  <span class="n">transform</span><span class="o">:</span> <span class="n">translateY</span><span class="p">(</span><span class="m">10px</span><span class="p">);</span>
<span class="p">}</span>

<span class="nc">.container__fixed-position-child</span> <span class="p">{</span>
  <span class="k">position</span><span class="o">:</span> <span class="k">fixed</span><span class="p">;</span>
  <span class="k">width</span><span class="o">:</span> <span class="m">100%</span><span class="p">;</span>
  <span class="k">height</span><span class="o">:</span> <span class="m">100%</span><span class="p">;</span>
  <span class="k">background</span><span class="o">:</span> <span class="nb">blue</span><span class="p">;</span>
  <span class="k">left</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span>
  <span class="k">top</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span>
<span class="p">}</span></code></pre></div>

<div class="container"><div class="left column">

<p>In my head the viewport is the initial containing block, not something else, but there’s a <a href="https://code.google.com/p/chromium/issues/detail?id=20574">bug open for Chrome</a>, and apparently the spec language needs clarification.</p>

<p>Personally I’d make <code>position: fixed</code> viewport-centric, because I think its current behavior is a little bonkers and I’m not sure the spec language is vague, but maybe I missed something. Here’s a demo of <a href="http://jsbin.com/kodoho/quiet">translates affecting fixed positioning</a>, in case you want to see it for yourself.</p>

<p>Oh, <a href="http://jsbin.com/semome/2/quiet">it also applies to <code>will-change</code></a>.</p>

<h2 id="body-scrolling-is-impossible-to-stop">2. Body scrolling is impossible to stop</h2>

<p>Let’s say you have a child element that takes over the full viewport with <code>position: fixed</code> (assuming it can… sigh.) and that the element has <code>overflow: scroll</code> because its content is longer than the viewport. Totally legit for an app with – say – a details view.</p>

<blockquote>
  <p>You can’t cancel scroll events, either, so there’s no evt.preventDefault() shenanigans that can save you.</p>
</blockquote>

<p>When the child element reaches the limits of its scrollable area, like when the user has scrolled to the top or bottom, the scroll event bubbles up and the body starts scrolling. Even if you tell it not to, seemingly. You can’t cancel <code>scroll</code> events, either, so there’s no <code>evt.preventDefault()</code> shenanigans that can save you.</p>

<p>An idea: how about we don’t put anything directly on the <code>body</code> element? Instead set <code>html</code> and <code>body</code> to <code>height: 100%</code> and set <code>overflow: hidden</code> and <em>then</em> create a new container element with <code>overflow: scroll</code> that acts as a replacement for the <code>body</code>. Now when your child element does its takeover you can set the container to <code>overflow: hidden</code>! (You can’t just do this to the body on the fly because it seems to change the scroll value when you change <code>overflow</code> and it snaps to the top of the page.)</p>

<p>Problems with this approach are two-fold:</p>

<ul>
  <li><strong>The container element doesn’t get compositor-supported fast scrolling in all browsers</strong>. That means slow scrolling and paints on every scroll change. Which generally means you just killed performance.</li>
  <li><strong>It looks weird on mobile.</strong> On mobile the address bar either disappears (Chrome on Android) or collapses (Mobile Safari) and this behavior is based on the scroll position of the body. Since we just killed that the bar stays there and you’re in an uncanny valley.</li>
</ul>

<p>Seems to me that this is a good reason to have <a href="https://groups.google.com/a/chromium.org/forum/#!msg/blink-dev/IpBdJEppjzE/V1Biy1D4v-kJ"><code>beforescroll</code></a>.</p>

<h2 id="popstate-causes-scrolls">3. Popstate causes scrolls</h2>

<p>This one I did not expect. If you’re using the HTML5 history gubbins, like <code>pushState</code> and all that, then the browser stores the scroll position whenever you use it. Then if the user clicks back or forward then the scroll position is restored. There’s nothing you can do about it. If you’re using the URL to toggle UI elements then it’s super jarring to have the page jump around the place.</p>

<blockquote>
  <p>I was all like you can totally capture the scroll position before the browser changes it in <code>popstate</code> then, when it’s done, just, you know, set the value back with <code>window.scrollTo</code>. Haha no.</p>
</blockquote>

<p>I did have an epiphany, I was all like you can totally capture the scroll position before the browser changes it in <code>popstate</code> then, when it’s done, just, you know, set the value back with <code>window.scrollTo</code>. Haha no. Firefox takes it upon itself to restore the scroll position <em>before</em> <code>popstate</code> fires, so you have no idea what to restore it to.</p>

<p>Probably another thing that could benefit from <code>beforescroll</code>, i.e. “Dear browser, please do not jump all over the place, I got this.”</p>

<h2 id="there-seems-to-be-no-form-of-clipping-thats-accelerated">4. There seems to be no form of clipping that’s accelerated</h2>

<p>You know me, I jabber on about performance a lot. I’ve specifically advocated to sticking to compositor-friendly animations like transform and opacity changes. But occasionally you need to do something which involves something more complex like clipping, where – say – a box expands or contracts and you don’t want the contents to flow out. Think a card expansion effect like the ones on Google+’s native app. Yeah, that’s the one.</p>

<p>Options for this are:</p>

<ol>
  <li>Have a container element with <code>overflow: hidden</code> and transition <code>width</code>, <code>height</code>, <code>left</code>, and <code>top</code>. Changing those properties <a href="http://csstriggers.com">triggers layout and paint</a> so that’s a performance no-no.</li>
  <li>Use <code>clip: rect()</code>, or its newer cousin, <code>clip-path</code>. Both of these trigger paint, which is unfortunate as again its difficult to guarantee 60fps when you do that.</li>
</ol>

<p>On the basis that there’s an <a href="https://www.opengl.org/wiki/Scissor_Test">OpenGL scissor test</a>, I’d hoped <code>clip</code> might get mapped to a scissor test for elements with their own compositor layer. Seemingly not. Bummer.</p>

<h2 id="conclusions">Conclusions</h2>

<p>These are only a few of the issues I hit building my current project, and there have been others I’ve worked around. But generally I find it’s these kinds of problems that cause developers to go offroad and reimplement things like scrolling, the DOM, or painting themselves. In my view that’s invariably a bad idea, because you’re fighting with the browser and reimplementing anything always involves a lot of extra code, maintenance and cross-browser wrangling.</p>

<p>I also feel like these deficiencies in the platform make it very difficult to make convincing web apps today, and if that’s what we’re trying to make then we should solve these problems, because they <em>are</em> solvable.</p>

<p>And mostly, what I think we need to do to solve them, is have more control.</p>

</div></div>


  <div class="footer-share container">
    Share this on: <span class="value"><a href="http://www.twitter.com/share?url=https://aerotwist.com/blog/some-gotchas-that-got-me/&text=Some Gotchas That Got Me">Twitter</a></span>
    <span class="value"><a href="https://plus.google.com/share?url=https://aerotwist.com/blog/some-gotchas-that-got-me/">Google+</a></span>
  </div>

  <div class="clear"></div>

  
    <svg class="left-shape" style="margin-left: -276.45px" width="407.4" height="1205.4">
      <use xlink:href="#color-block" filter="url(#blur-4)" transform="scale(-1.4 1.4) rotate(90)"/>
    </svg>

    <svg class="right-shape" width="145.5" height="774.9">
      <use xlink:href="#color-block" filter="url(#blur-8)" transform="scale(-0.9 0.9) rotate(90)"/>
    </svg>
  

</div>


    </section>

    <footer>

      <div class="container">
        <div class="bio panel">
          <h2>Hello!</h2>
          <p>My name is Paul. I work at <a href="http://www.google.com/" title="Some cloud company in the USA, I think.">Google</a> on the Chrome Developer Relations team as an advocate. I help developers improve the performance of their sites and apps.</p>

          <p>You can find me on <a href="http://twitter.com/aerotwist">Twitter</a> and <a href="http://www.google.com/+aerotwist">G+</a></p>
        </div>

        <div class="get-in-touch panel">
          <h2>Get in touch</h2>
          <p>I don’t bite. Honestly. You can find me on <a href="https://twitter.com/aerotwist">Twitter</a> and <a href="http://www.google.com/+aerotwist">G+</a>, and I like hearing from people (pretty handy given my job, really) so say hi.</p>
        </div>

        <div class="subscribe panel">
          <h2>Subscribe</h2>
          <p>You should totally get the <a href="/blog/feed/">RSS feed</a>, or whatever it is you kids are using these days (I miss Reader.)</p>
        </div>

        <p class="disclaimer">Except as otherwise noted, the content of this page is licensed under the Creative Commons Attribution 3.0 License, and code samples are licensed under the Apache 2.0 License.</p>
      </div>
    </footer>

    <script async="true">

    /**
     * Snow effect, from: HTML5 Rocks
     * https://github.com/html5rocks/www.html5rocks.com/blob/9318b5755c8c17a4bd1761bca6b1b491e7fd17b8/content/index.html
     */
    !function(){function j(){f=c.clientWidth,g=c.clientHeight,d.width=f,d.height=g,e.fillStyle="#FFF";var a=i;i=f>600,!a&&i&&requestAnimFrame(n)}function n(){if(e.clearRect(0,0,f,g),i){for(h=0;b>h;h++)m=l[h],m.y+=m.vy,m.x+=m.vx,e.globalAlpha=m.o,e.beginPath(),e.arc(m.x,m.y,m.r,0,2*Math.PI,!1),e.closePath(),e.fill(),m.y>g&&m.reset();requestAnimFrame(n)}}var a=(new Date).getMonth();if(11===a){var b=100,c=document.querySelector(".masthead");if(c){var d=document.createElement("canvas"),e=d.getContext("2d"),f=c.clientWidth,g=c.clientHeight,h=0,i=!1,k=function(){this.x=0,this.y=0,this.vy=0,this.vx=0,this.r=0,this.reset()};k.prototype.reset=function(){this.x=Math.random()*f,this.y=Math.random()*-g,this.vy=1+3*Math.random(),this.vx=.5-Math.random(),this.r=1+2*Math.random(),this.o=.5+.5*Math.random()},d.style.position="absolute",d.style.left=d.style.top="0";var m,l=[];for(h=0;b>h;h++)m=new k,m.reset(),l.push(m);window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)}}(),j(),window.addEventListener("resize",j,!1),c.appendChild(d)}}

    if (!('IntersectionObserver' in window)) {
      return;
    }

    var masthead = document.querySelector('.masthead');
    if (!masthead) {
      return;
    }

    var observer = new IntersectionObserver(function(entries) {
      entries.sort(function(a, b) {
        return b.time - a.time;
      });

      var isActive = i;
      i = entries[0].intersectionRatio > 0.01;

      if (i && !isActive) {
        console.log('***** LET IT SNOWWWWW!!!! *****');
        requestAnimFrame(n);
      } else {
        if (i !== isActive) {
          console.log('Forecast: no snow.');
        }
      }

    }, { rootMargin: '0px', threshold: 0.01 });

    observer.observe(masthead);
    }();
    </script>

    <script type="text/javascript" async="true">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-13024693-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
  </body>
</html>
